(ns game-of-life.templates
  
  (:require [clojure.string :as str]))


(def string-templates
  
  {:pulsar
   "
     ..OOO...OOO..
     .............
     O....O.O....O
     O....O.O....O
     O....O.O....O
     ..OOO...OOO..
     .............
     ..OOO...OOO..
     O....O.O....O
     O....O.O....O
     O....O.O....O
     .............
     ..OOO...OOO..
   "


   :blinker
   "
     OOO
   "


   :toad
   "
     .OOO
     OOO.
   "


   :beacon
   "
     OO...
     OO...
     ..OO
     ..OO
   "


   :glider
   "
     ..O
     O.O
     .OO
   "


   :r-pentomino
   "
     .OO
     OO.
     .O.
   "


   :gosper-glider-gun
   "
     ........................O...........
     ......................O.O...........
     ............OO......OO............OO
     ...........O...O....OO............OO
     OO........O.....O...OO..............
     OO........O...O.OO....O.O...........
     ..........O.....O.......O...........
     ...........O...O....................
     ............OO......................
   "


   :lightweight-space-ship
   "
     .O..O
     O....
     O...O
     OOOO.
   "


   ;; By Bill Gosper, 1971
   :puffer-train-1
   "
     .OOO......O.....O......OOO.
     O..O.....OOO...OOO.....O..O
     ...O....OO.O...O.OO....O...
     ...O...................O...
     ...O..O.............O..O...
     ...O..OO...........OO..O...
     ..O...OO...........OO...O..
   "


   ;; By Richard Schank, 2014
   :puffer-train-2
   "
     ...O.......O...
     ..OOO.....OOO..
     .OO..O...O..OO.
     ...OOO...OOO...
     ...............
     ....O.....O....
     ..O..O...O..O..
     O.....O.O.....O
     OO....O.O....OO
     ......O.O......
     ...O.O...O.O...
     ....O.....O....
   "


   ;; By Bill Gosper, 1970
   :p60-gun
   "
	   ............................O..........
	   ............................O.O........
	   ...........OO..................OO......
	   .........O...O.................OO....OO
	   ...OO...O.....O................OO....OO
	   ...OO..OO.O...O.............O.O........
	   ........O.....O.............O..........
	   .........O...O.........................
	   ...........OO..........................
	   .......................................
	   .......................................
	   .......................................
	   .......................................
	   .......................................
	   .......................................
	   .......................................
	   ..........O.O..........................
	   .........O..O...OO.....................
	   OO......OO.....OOO.OO..OO..............
	   OO....OO...O...O...O...O.O.............
	   ........OO.....O.O........O............
	   .........O..O..OO......O..O............
	   ..........O.O.............O............
	   .......................O.O.......OO....
	   .......................OO........O.O...
	   ...................................O...
	   ...................................OO..
   "
   
   ;; By Nicolay Beluchenko 2004.
   :shuttle
   "
     O.............
	   OOO...........
	   ...O..........
	   ..OO..........
	   ..............
	   ......O.......
	   .....OOOO.....
	   ......O..O....
	   .......OOO....
	   ..............
	   ..........OO..
	   ..........O...
	   ...........OOO
	   .............O
    "
   
   ;; By Earl Abbe, 1971
   :washerwoman
   "
	   O.......................................................
	   OO....O.....O.....O.....O.....O.....O.....O.....O.....O.
	   OOO..O.O...O.O...O.O...O.O...O.O...O.O...O.O...O.O...O.O
	   OO....O.....O.....O.....O.....O.....O.....O.....O.....O.
	   O.......................................................
   "
   
   ;; By Eppstein, 2000
   :weekender
   "
	   .O............O.
	   .O............O.
	   O.O..........O.O
	   .O............O.
	   .O............O.
	   ..O...OOOO...O..
	   ......OOOO......
	   ..OOOO....OOOO..
	   ................
	   ....O......O....
	   .....OO..OO.....
   "
   
   ;; 1992
   :wickstretcher
   "
	   .................OO..............................
	   .............OO....O.............................
	   ............OOO.O................................
	   O.OO..OO...O...OOOO.O.O....OO.......OO...........
	   O....OO..O........O.OOO....O....OO.O..O.OO.O.....
	   O.OO....OO.OO....O...........O...O.O.OO.O.OO.....
	   ......O.......O.............OO.....O..O.O...OO...
	   .....O.........O.O....OOO...O....O..O.O.OOO...O..
	   .....O.........O.O....OOO.OO.O..OO.O.O...O..OO.O.
	   ......O.......O.............OO.O...OO....OO....O.
	   O.OO....OO.OO....O..........O........OO.O.O.OO.OO
	   O....OO..O........O.OOO........O...O...OO.O..O.O.
	   O.OO..OO...O...OOOO.O.O.......O.O...OO....O..O.O.
	   ............OOO.O..............O.....O.OOO....O..
	   .............OO....O.................O.O.........
	   .................OO...................O..........
   "})


(defn parse-template [string-template]

  (some-> string-template
          (str/trim)
          (str/split #"\n")
          (->> (map str/trim))))


(defn get-template [id]
  
  (parse-template
   (get string-templates id)))


(defn rotate-template [template]
  
  (loop [n                0
         rotated-template []]

    (if (= n (count (first template)))

      (map str/join rotated-template)

      (recur (inc n)
             (conj rotated-template
                   (map #(nth % n) template))))))


(defn template-width [template]

  (count (first template)))


(defn template-height [template]

  (count template))
